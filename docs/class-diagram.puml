@startuml Revellio Architecture

package "UI Layer" {
  class FileDrop {
    +onFilesSelected(files: File[])
    +accept: string
    +maxFiles?: number
  }
  
  class VisualizationBlock {
    +render(data: ProcessedData)
    +explain(): string
  }
}

package "Data Processing Layer" {
  class CSVParser {
    +parse(file: File): CSVData
    +validate(data: string): boolean
  }
  
  class DataProcessor {
    +process(csvData: CSVData[]): ProcessedData
    +aggregate(data: ProcessedData): AggregatedData
  }
  
  class DataValidator {
    +validate(data: CSVData): ValidationResult
    +checkQuality(data: CSVData): QualityReport
  }
}

package "Analysis Layer" {
  class MetadataExtractor {
    +extract(csvData: CSVData): Metadata
    +getColumnTypes(data: CSVData): ColumnType[]
    +getSample(data: CSVData, count: number): SampleData
  }
  
  class StructureAnalyzer {
    +analyze(metadata: Metadata[]): Structure
    +findRelations(metadata: Metadata[]): Relation[]
    +detectSemanticOverlap(metadata: Metadata[]): Overlap[]
  }
}

package "AI Layer" {
  class AIService {
    +analyzeMetadata(metadata: Metadata[]): AIAnalysis
    +suggestVisualizations(structure: Structure): VisualizationSuggestion[]
    +explainDecision(decision: Decision): Explanation
    +identifyRelations(metadata: Metadata[]): Relation[]
  }
}

package "Types" {
  class CSVData {
    +columns: string[]
    +rows: Row[]
    +metadata: Metadata
  }
  
  class Metadata {
    +columnNames: string[]
    +columnTypes: ColumnType[]
    +sample: SampleData
  }
  
  class ProcessedData {
    +raw: CSVData[]
    +merged?: MergedData
    +structure: Structure
  }
  
  class VisualizationSuggestion {
    +type: VisualizationType
    +data: ProcessedData
    +explanation: string
  }
}

' Relationships
FileDrop --> CSVParser : uses
FileDrop --> DataProcessor : uses

CSVParser --> CSVData : creates
DataProcessor --> ProcessedData : creates
DataValidator --> CSVData : validates

MetadataExtractor --> CSVData : extracts from
MetadataExtractor --> Metadata : creates
StructureAnalyzer --> Metadata : analyzes

AIService --> Metadata : analyzes
AIService --> StructureAnalyzer : uses
AIService --> VisualizationSuggestion : creates

VisualizationBlock --> ProcessedData : displays
VisualizationBlock --> VisualizationSuggestion : uses

@enduml